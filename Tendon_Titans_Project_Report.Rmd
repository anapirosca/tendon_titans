---
title: "Module 7 Project Report"
author: "Ana Pirosca, Jonah Kotzen, Katie Miller, Jessica Stolz"
date: '`r Sys.Date()`'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(MuMIn)
library(tidyverse)
```

## Introduction
How do muscles work when you're tired? Recognizing the fundamental role of length in muscle force generation, we will explore the impact of fatigue on the force-length relationship, particularly focusing on the upper limb's forearm flexors and their 3rd order lever system. While previous research has delved into the basics of muscle mechanics, the missing piece that makes our study relevant is a comprehensive exploration of how fatigue specifically influences the force-length relationship in the context of isometric muscle contractions, offering insights into practical scenarios like sustained muscle effort or prolonged physical activity [ANA WILL INSERT CITATION HERE].

Thus, we have two big questions: First, do the data about how much force your muscles can make match a certain pattern when you're pushing against something? Second, does the angle at which your muscles work change when you're tired compared to when you're not tired? Our investigation dives into the biomechanical aspects of muscle architecture, considering the mediation of force at the fiber level by crossbridges and the implications of lever configurations. 

## Methods
In order to answer the questions above, we obtained experimental data by fabricating and programming a load-cell data acquisition system (via Arduino) then we recorded isometric MVCs at 12 distinct elbow angle by moving the upper body in different locations relative to the goniometer that is secured to a table. In orer to obtain fatigued data, we eccentrically lowered heavy items with the same arm used in the initial experiment, waited two minutes, then performed the isometric MVCs again. 

In terms of how the class-wide data for an isometric MVC match a typical Force-Length relationship under control and fatigued conditions, we first normalized the data in order to make every student's relative force comparable. Then, we created a polynomial model in order to predict the maximum force at a specified angle under fatigued and non-fatigued conditions. In order to understand whether the differences observed in the maximum forces of the muscles were statistically significant, we conducted an ANOVA analysis.

```{r}
# I'm creating a nice big tibble named "combined_data" of everyone's data so it might be easier to use
file_paths <- list.files(pattern = ".csv", full.names = TRUE, recursive = TRUE)
combined_data <- tibble()
for (file_path in file_paths) {
  file_name <- basename(file_path)
  name <- str_extract(file_name, "(Ana|Jess|Jonah|Katie)")
  state <- str_extract(file_name, "(Control|Fatigue)")
  angle <- str_extract(file_name, "_([0-9]+)$") %>% str_remove("_")

data <- read.csv(file_path, skip = 1) 
  data_tibble <- as_tibble(data)  
  data_combined <- bind_cols(
    tibble(name = name, state = state, angle = angle),
    data_tibble
  )
combined_data <- bind_rows(combined_data, data_combined)
}
```

```{r, comparing isometric MVCs}
#finding the maximum Force (Fmax) and the angle it occurs
normF <- c(#gonna put values in here :])%>%
  ang[which.max(normF)]
  
#modeling for a better Fmax
poly.m2 <- lm(normF~poly(ang,2)) 
poly.m3 <- lm(normF~poly(ang,3)) 
poly.m4 <- lm(normF~poly(ang,4))
AICc(poly.m2,poly.m3,poly.m4)

x.pred <- seq(45,157.5,length.out = 1000)
```


## Results

## Discussion

## Author Contributions
Jonah - Methods 
Katie - Data collection + set up 
Ana - Methods 
Jess 
